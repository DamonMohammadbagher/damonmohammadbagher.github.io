<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1256">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">
<link rel="stylesheet" type="text/css" href="styles.css" />
<link rel=File-List href="1jun2020x_files/filelist.xml">
<link rel=Edit-Time-Data href="1jun2020x_files/editdata.mso">

<link rel=themeData href="1jun2020x_files/themedata.thmx">
<link rel=colorSchemeMapping href="1jun2020x_files/colorschememapping.xml">

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:32771 0 0 0 1 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520081665 -1073717157 41 0 66047 0;}
@font-face
	{font-family:"Liberation Serif";
	mso-font-alt:"Times New Roman";
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Liberation Sans";
	mso-font-alt:Arial;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"DejaVu Sans";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Times New Roman";
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan no-line-numbers;
	font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;
	font-style:italic;}
p.MsoList, li.MsoList, div.MsoList
	{mso-style-unhide:no;
	mso-style-parent:"Body Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:7.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-unhide:no;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:7.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	mso-bidi-font-size:7.0pt;
	font-family:"Tahoma","sans-serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:Mangal;
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.5pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:Mangal;
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.5pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:Mangal;
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.5pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:Mangal;
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.5pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:Mangal;
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
span.InternetLink
	{mso-style-name:"Internet Link";
	mso-style-unhide:no;
	mso-style-parent:"";
	color:navy;
	text-decoration:underline;
	text-underline:single;}
span.ListLabel1
	{mso-style-name:"ListLabel 1";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";}
p.Heading, li.Heading, div.Heading
	{mso-style-name:Heading;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:"Body Text";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Liberation Sans","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
p.Index, li.Index, div.Index
	{mso-style-name:Index;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan no-line-numbers;
	font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-bidi-font-family:"DejaVu Sans";
	color:#00000A;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:7.0pt;
	font-family:"Tahoma","sans-serif";
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Mangal;
	color:#00000A;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Liberation Serif","serif";
	mso-ascii-font-family:"Liberation Serif";
	mso-fareast-font-family:"DejaVu Sans";
	mso-hansi-font-family:"Liberation Serif";
	mso-bidi-font-family:"DejaVu Sans";
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;
	mso-bidi-language:HI;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:56.7pt 7.15pt 56.7pt 9.4pt;
	mso-header-margin:0in;
	mso-footer-margin:0in;
	mso-forms-protection:no;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:437218364;
	mso-list-type:hybrid;
	mso-list-template-ids:150739432 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1
	{mso-list-id:872887932;
	mso-list-type:hybrid;
	mso-list-template-ids:-102473204 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='tab-interval:35.45pt'>

<div class=WordSection1>
<div id="header"><h1>Bypassing Anti-Viruses with Thread Injection Technique +
C# Delegate &amp; ETW</h1></div>
<p class=MsoNormal><b><o:p></o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><span class=GramE>as</span> you can in these Pictures, I
used very simple C# code for Thread Injection Method also in this code API
Function Called via "C# Delegate" Technique.</p>

<p class=MsoNormal>Research Result for some <span class=SpellE>Avs</span> was
very good as you can see ESET, McAfee bypassed also I tested this method for
some other <span class=SpellE>Avs</span> like Windows Defender which bypassed
too.</p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b><span style='mso-fareast-language:EN-US;mso-bidi-language:
FA;mso-no-proof:yes'><![if !vml]><img width=1320 height=528
src="1jun2020x_files/image002.jpg"
 v:shapes="Picture_x0020_6"><![endif]></span><o:p></o:p></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Picture 1: McAfee Bypassed (last update: 3/17/2020) </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span class=GramE>as</span> you can see I had shell without
any problem</p>

<p class=MsoNormal><span class=GramE>now</span> I want to talk about ESET, this
Av in the last year had very good steps to protect Process in memory
(monitoring process memory)</p>

<p class=MsoNormal><span class=GramE>but</span> in this case bypassed by C#
code as you can see in the next Pictures 2 &amp; 3.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-fareast-language:EN-US;mso-bidi-language:
FA;mso-no-proof:yes'><![if !vml]><img width=1308 height=503
src="1jun2020x_files/image004.jpg"
 v:shapes="Picture_x0020_7"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Picture 2: ESET Bypassed (last update: 5/29/2020)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span class=GramE>this</span> is very classic technique for
Thread Injection into Target Process for more information about this method you
can read these articles: </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span dir=LTR></span><a
href="https://www.linkedin.com/pulse/bypassing-anti-virus-creating-remote-thread-target-mohammadbagher/"><span
style='color:navy'>https://www.linkedin.com/pulse/bypassing-anti-virus-creating-remote-thread-target-mohammadbagher/</span></a></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l0 level1 lfo2'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span dir=LTR></span><a
href="https://www.peerlyst.com/posts/bypassing-anti-virus-by-creating-remote-thread-into-target-process-damon-mohammadbagher?trk=profile_page_overview_panel_posts"><span
style='color:navy'>https://www.peerlyst.com/posts/bypassing-anti-virus-by-creating-remote-thread-into-target-process-damon-mohammadbagher</span></a></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>I will <span class=GramE>Publish</span> C# code for this in
the next [chapter-14] of eBook "Bypassing Avs by C#
Programming" soon. In this chapter I will talk about C# Delegate Technique also
Thread Injection Method by C# <span class=SpellE>etc</span></p>

<p class=MsoNormal>But in this Page I want to talk about one Important
Point about ESET and other <span class=SpellE>Avs</span>.</p>

<p class=MsoNormal>In the next pictures 3 &amp; 4 you can see <span
class=SpellE>Meterpreter</span> Payload Injected to "Notepad.exe" process by
"NativePayload_TId.exe" code &amp; this Injection "Not Detected" by AV but when
I used shell command then payload in Notepad.exe (in-Memory) detected by ESET
very good.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-fareast-language:EN-US;mso-bidi-language:
FA;mso-no-proof:yes'><![if !vml]><img border=0 width=1304 height=465
src="1jun2020x_files/image006.jpg"
 v:shapes="Picture_x0020_8"><![endif]></span></p>

<p class=MsoNormal>Picture 3: Shell code detected by <span class=GramE>ESET<span
style='mso-spacerun:yes'>  </span>(</span>last update: 5/29/2020)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-fareast-language:EN-US;mso-bidi-language:
FA;mso-no-proof:yes'><![if !vml]><img border=0 width=1323 height=540
src="1jun2020x_files/image008.jpg"
 v:shapes="Picture_x0020_9"><![endif]></span></p>

<p class=MsoNormal>Picture 4: in memory shell detected by <span class=GramE>ESET<span
style='mso-spacerun:yes'>  </span>(</span>last update: 5/29/2020)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Important point is this Payload Detected but C# Injector
Code in this case "NativePayload_TId.exe" was not <span class=GramE>Detected</span>
by AV.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal>In step1 of attack I used four "API Function" to create Remote
Thread in target Process in this case "Notepad.exe" in this step AV should
detect this but for reasons Not Detected.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Now in step2 of attack <span class=SpellE>Meterpreter</span>
Shell Code Detected (in Memory) by ESET very good but only in Log file We have
Notepad.exe process as you can see we don't have C# Code so this is why this
Code still is hidden from some <span class=SpellE>Avs</span> in this case ESET.
</p>

<p class=MsoNormal>Maybe because signature for C# code was not detected by <span
class=SpellE>av</span> so ESET anti-virus think this code is ok, maybe but
after detect that shell code AV should read event logs to find injector
process or any <span class=SpellE>dll</span> or something like that .<b> (we
should try to find out how this Notepad process Infected in-memory?) <o:p></o:p></b></p>

<p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b>ETW &amp; Remote Thread Injection Method<o:p></o:p></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span class=GramE>in</span> this case (Event Trace for
Windows) ETW can help us to find out which Processes was Injector for that
Thread/s into "Notepad.exe", </p>

<p class=MsoNormal><span class=GramE>as</span> you can see with this C# code "<span
class=SpellE>ETWMonThread.cs</span>" you can Detect all Injected Threads to
Processes very simple. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span class=SpellE><span class=GramE>ETWMonThread.cs</span></span><span
class=GramE> :</span> <a
href="https://github.com/DamonMohammadbagher/Meterpreter_Payload_Detection/tree/master/MPD/ETWMonThread"><span
style='color:navy'>https://github.com/DamonMohammadbagher/Meterpreter_Payload_Detection/tree/master/MPD/ETWMonThread</span></a></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>With this ETW code you can find all injected Threads by
Thread Monitoring (real-time) also with this code you can Terminate/stop that
Thread which was for <span class=SpellE>Meterpreter</span> Process and finally
with ETW you can See which Process was Injector to which Process (in this case
notepad.exe).<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><span style='mso-fareast-language:EN-US;mso-bidi-language:
FA;mso-no-proof:yes'><![if !vml]><img border=0 width=1184 height=626
src="1jun2020x_files/image010.jpg"
 v:shapes="Picture_x0020_10"><![endif]></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Picture 5: <span class=SpellE><span class=GramE>ETWMonThread.cs</span></span><span
class=GramE><span style='mso-spacerun:yes'>  </span>(</span>TID:900 Injected to
PID:4108 by Malware Process PID:4632)</p>

<p class=MsoNormal><o:p> </o:p></p>
<p class=MsoNormal><span class=SpellE><span class=GramE>Video ETWMonThread.cs [step by step]: </span></span><span
class=GramE> :</span> <a
href="https://www.youtube.com/watch?v=nIoDrqeQ2es">
<p class=MsoNormal><o:p> </o:p></p>
<p class=MsoNormal><o:p> </o:p></p>
<p class=MsoNormal><span class=GramE>as</span> you can see this ETW is very
useful thing for Thread Monitoring also is useful to show Injected Threads also
Injector Processes... (Sometimes) and I think Some Anti-viruses need to use this
ETW or something like this always...</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>
 
<div id="footer">
    <p>Last Update: 1 Jun 2020 </p>
  </div>
</div>

</body>

</html>
